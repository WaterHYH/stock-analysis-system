<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>股票数据列表</title>
    <style>
        /* 分页容器固定定位样式 */
        .pagination {
            /* 固定定位在视口底部 */
            position: fixed;
            /* 距离底部20px */
            bottom: 20px;
            /* 水平居中定位 */
            left: 50%;
            /* X轴反向平移50%实现居中 */
            transform: translateX(-50%);
            /* 白色背景 */
            background: white;
            /* 内边距15px */
            padding: 15px;
            /* 8px圆角边框 */
            border-radius: 8px;
            /* 添加阴影效果 */
            box-shadow: 0 2px 15px rgba(0,0,0,0.1);
            /* 确保分页在最顶层 */
            z-index: 1000;

            /* 新增单行滚动布局 */
            /* 启用flex布局 */
            display: flex;
            /* 禁止换行 */
            flex-wrap: nowrap;
            /* 横向溢出显示滚动条 */
            overflow-x: auto;
            /* 按钮间距8px */
            gap: 8px;
            /* 限制最大宽度为视口宽度-40px */
            max-width: calc(100vw - 40px);
        }

        /* 分页链接样式优化 */
        .pagination a {
            /* 行内flex布局 */
            display: inline-flex;
            /* 垂直居中 */
            align-items: center;
            /* 水平居中 */
            justify-content: center;
            /* 内边距8px上下，16px左右 */
            padding: 8px 16px;
            /* 外边距0上下，4px左右 */
            margin: 0 4px;
            /* 1px灰色边框 */
            border: 1px solid #ddd;
            /* 4px圆角 */
            border-radius: 4px;
            /* 移除下划线 */
            text-decoration: none;
            /* 深灰色文字 */
            color: #333;
            /* 防止内容压缩 */
            flex-shrink: 0;
            /* 最小宽度36px */
            min-width: 36px;
            /* 添加过渡动画 */
            transition: all 0.2s;
        }

        /* 当前页样式 */
        .pagination a.current {
            /* 蓝色背景 */
            background-color: #007bff;
            /* 白色文字 */
            color: white;
            /* 边框颜色与背景一致 */
            border-color: #007bff;
        }

        /* 滚动条样式优化 */
        /* WebKit浏览器滚动条整体样式 */
        .pagination::-webkit-scrollbar {
            height: 6px;
        }

        /* 滚动条轨道样式 */
        .pagination::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        /* 滚动条滑块样式 */
        .pagination::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 3px;
        }

        /* 响应式调整 */
        @media (max-width: 768px) {
            /* 移动端按钮缩小 */
            .pagination a {
                min-width: 32px;
                padding: 6px 12px;
            }
        }

        /* 表格容器：控制横向滚动 */
        .table-container {
            overflow-x: auto; /* 启用横向滚动 */
            -webkit-overflow-scrolling: touch; /* 移动端滚动优化 */
            width: 100%;
            margin-bottom: 120px; /* 为分页栏预留空间 */
        }

        /* 表格样式 */
        .stock-table {
            width: max-content; /* 让表格宽度由内容决定 */
            min-width: 100%; /* 至少撑满容器 */
            table-layout: auto; /* 列宽根据内容自适应 */
            border-collapse: collapse;
        }

        /* 单元格样式 */
        .stock-table td, .stock-table th {
            white-space: nowrap; /* 禁止换行 */
            text-overflow: clip; /* 禁用省略号 */
            padding: 8px 16px; /* 合理间距 */
            border: 1px solid #ddd;
        }

        /* 可选：给表头添加固定背景 */
        .stock-table thead th {
            position: sticky;
            left: 0;
            background: white;
            z-index: 1;
        }
    </style>
</head>
<body>

<!-- 股票搜索表单 -->
<form th:action="@{/stocks}" method="get">
    <input type="text" name="symbol" placeholder="输入股票代码" th:value="${symbol}">
    <button type="submit">搜索</button>
</form>

<!-- 股票数据表格容器 -->
<div class="table-container">
<table class="stock-table">
    <thead>
    <tr>
        <!-- 基础信息 -->
        <th class="fixed-col">代码</th>
        <th>名称</th>

        <!-- 核心价格信息 -->
        <th>最新价</th>
        <th>涨跌额</th>
        <th>涨跌幅</th>
        <th>昨收</th>
        <th>今开</th>
        <th>最高</th>
        <th>最低</th>

        <!-- 买卖盘信息 -->
        <th>买一价</th>
        <th>卖一价</th>

        <!-- 成交量与金额 -->
        <th>成交量(股)</th>
        <th>成交额(元)</th>

        <!-- 财务指标 -->
        <th>市盈率</th>
        <th>市净率</th>
        <th>总市值</th>
        <th>流通市值</th>
        <th>换手率</th>

        <!-- 时间信息 -->
        <th>最后交易</th>
        <th>更新时间</th>
    </tr>
    </thead>
    <tbody>
    <!-- 遍历显示股票数据 -->
    <tr th:each="stock : ${stocks.content}">
        <!-- 基础信息 -->
        <td class="fixed-col" th:text="${stock.symbol}">000001</td>
        <td th:text="${stock.name}">示例股票</td>

        <!-- 核心价格列 -->
        <!-- tradePrice (precision=12, scale=4) -->
        <td th:text="${stock.tradePrice != null} ?
                ${#numbers.formatDecimal(stock.tradePrice, 1, 2)} : '--'">
            12.3450
        </td>

        <!-- priceChange (precision=12, scale=4) -->
        <td th:text="${stock.priceChange != null} ?
                ${#numbers.formatDecimal(stock.priceChange, 1, 2)} : '--'"
            th:styleappend="${stock.priceChange != null} ?
                (${stock.priceChange} >= 0 ? 'color:red;' : 'color:green;') : ''">
            +0.1234
        </td>

        <!-- changePercent (precision=6, scale=3) -->
        <td th:text="${stock.changePercent != null} ?
                ${#numbers.formatDecimal(stock.changePercent, 1, 2)} + '%' : '--'"
            th:styleappend="${stock.changePercent != null} ?
                (${stock.changePercent} >= 0 ? 'color:red;' : 'color:green;') : ''">
            1.234%
        </td>

        <!-- previousClose (precision=12, scale=4) -->
        <td th:text="${stock.previousClose != null} ?
                ${#numbers.formatDecimal(stock.previousClose, 1, 2)} : '--'">
            12.2200
        </td>

        <!-- openPrice (precision=12, scale=4) -->
        <td th:text="${stock.openPrice != null} ?
                ${#numbers.formatDecimal(stock.openPrice, 1, 2)} : '--'">
            12.3000
        </td>

        <!-- highPrice (precision=12, scale=4) -->
        <td th:text="${stock.highPrice != null} ?
                ${#numbers.formatDecimal(stock.highPrice, 1, 2)} : '--'">
            12.5000
        </td>

        <!-- lowPrice (precision=12, scale=4) -->
        <td th:text="${stock.lowPrice != null} ?
                ${#numbers.formatDecimal(stock.lowPrice, 1, 2)} : '--'">
            12.2000
        </td>

        <!-- bidPrice (precision=12, scale=4) -->
        <td th:text="${stock.bidPrice != null} ?
                ${#numbers.formatDecimal(stock.bidPrice, 1, 2)} : '--'">
            12.3400
        </td>

        <!-- askPrice (precision=12, scale=4) -->
        <td th:text="${stock.askPrice != null} ?
                ${#numbers.formatDecimal(stock.askPrice, 1, 2)} : '--'">
            12.3500
        </td>

        <!-- volume -->
        <td th:text="${stock.volume != null} ?
                ${#numbers.formatInteger(stock.volume, 0, 'COMMA')} : '--'">
            1,234,567
        </td>

        <!-- amount (precision=20, scale=4) -->
        <td th:text="${stock.amount != null} ?
                '¥' + ${#numbers.formatDecimal(stock.amount, 1, 2)} : '--'">
            ¥123,456.7890
        </td>

        <!-- peRatio (precision=10, scale=2) -->
        <td th:text="${stock.peRatio != null} ?
                ${#numbers.formatDecimal(stock.peRatio, 1, 2)} : '--'">
            15.34
        </td>

        <!-- pbRatio (precision=10, scale=3) -->
        <td th:text="${stock.pbRatio != null} ?
                ${#numbers.formatDecimal(stock.pbRatio, 1, 2)} : '--'">
            1.234
        </td>

        <!-- marketCap (precision=20, scale=4) -->
        <td th:text="${stock.marketCap != null} ?
                '¥' + ${#numbers.formatDecimal(stock.marketCap, 1, 2)} : '--'">
            ¥1.2345万亿
        </td>

        <!-- circulatingMarketCap (precision=20, scale=4) -->
        <td th:text="${stock.circulatingMarketCap != null} ?
                '¥' + ${#numbers.formatDecimal(stock.circulatingMarketCap, 1, 2)} : '--'">
            ¥9876.5432亿
        </td>

        <!-- turnoverRate (precision=10, scale=5) -->
        <td th:text="${stock.turnoverRate != null} ?
                ${#numbers.formatDecimal(stock.turnoverRate, 1, 2)} + '%' : '--'">
            1.23456%
        </td>

        <!-- 时间信息 -->
        <td th:text="${stock.lastTradeTime != null} ?
                ${#temporals.format(stock.lastTradeTime, 'HH:mm:ss')} : '--'">
            15:00:00
        </td>
        <td th:text="${stock.createdAt != null} ?
                ${#temporals.format(stock.createdAt, 'yyyy-MM-dd HH:mm')} : '--'">
            2023-08-10 15:30
        </td>
    </tr>
    </tbody>
</table>
</div>

<!-- 分页导航 -->
<div class="pagination" th:if="${stocks.totalPages > 1}">
    <span th:if="${!stocks.first}">
        <a th:href="@{/stocks(page=0, size=${stocks.size}, symbol=${symbol})}">首页</a>
    </span>
    <span th:if="${!stocks.first}">
        <a th:href="@{/stocks(page=${stocks.number - 1}, size=${stocks.size}, symbol=${symbol})}">上页</a>
    </span>

    <span th:each="i : ${#numbers.sequence(0, stocks.totalPages - 1)}">
        <a th:href="@{/stocks(page=${i}, size=${stocks.size}, symbol=${symbol})}"
           th:text="${i + 1}"
           th:classappend="${i == stocks.number} ? 'current'"></a>
    </span>

    <span th:if="${!stocks.last}">
        <a th:href="@{/stocks(page=${stocks.number + 1}, size=${stocks.size}, symbol=${symbol})}">下页</a>
    </span>
    <span th:if="${!stocks.last}">
        <a th:href="@{/stocks(page=${stocks.totalPages - 1}, size=${stocks.size}, symbol=${symbol})}">末页</a>
    </span>
</div>

</body>
</html>
